<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Run: Kingdom - Team Optimizer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üç™ Cookie Run: Kingdom</h1>
            <h2>Team Optimizer</h2>
            <p class="subtitle">Build the ultimate team with AI-powered optimization</p>
        </header>

        <!-- Control Panel -->
        <div class="control-panel">
            <h3>‚öôÔ∏è Optimization Settings</h3>

            <div class="settings-grid">
                <!-- Method Selection -->
                <div class="setting-group">
                    <label for="method">Optimization Method</label>
                    <select id="method" class="input-field">
                        <option value="random">Random Sampling (Fast)</option>
                        <option value="greedy">Greedy Algorithm (Power-focused)</option>
                        <option value="genetic" selected>Genetic Algorithm (Best) ‚≠ê</option>
                        <option value="exhaustive">Exhaustive Search (Requires 3+ cookies)</option>
                    </select>
                    <small class="help-text">Genetic algorithm recommended for best results</small>
                </div>

                <!-- Number of Candidates -->
                <div class="setting-group">
                    <label for="numCandidates">Candidates / Generations</label>
                    <input type="number" id="numCandidates" class="input-field" value="100" min="10" max="10000">
                    <small class="help-text">Higher = better quality (but slower)</small>
                </div>

                <!-- Top N Teams -->
                <div class="setting-group">
                    <label for="topN">Teams to Show</label>
                    <input type="number" id="topN" class="input-field" value="5" min="1" max="50">
                    <small class="help-text">Number of top teams to display</small>
                </div>

                <!-- Exclude Ascended Cookies -->
                <div class="setting-group">
                    <label class="checkbox-setting-label">
                        <input type="checkbox" id="excludeAscended">
                        <span>Exclude Ascended Cookies</span>
                    </label>
                    <small class="help-text">Hide Ascended versions from lists and optimization</small>
                </div>
            </div>

            <!-- Required Cookies Section (Redesigned) -->
            <div class="required-cookies-section">
                <h4>üîí Required Cookies (Build Around)</h4>
                <p class="help-text">Select up to 5 cookies that must be in every team</p>

                <!-- Selected Cookies Display -->
                <div id="selectedCookies" class="selected-cookies">
                    <p class="no-selection">No cookies selected - will optimize all combinations</p>
                </div>

                <!-- Search Bar -->
                <input type="text" id="cookieSearch" class="search-input" placeholder="üîç Search cookies to add...">

                <!-- Scrollable Cookie List -->
                <div id="cookieList" class="cookie-list-scrollable"></div>
            </div>

            <!-- Cookie Stats Input Section (Modal-based) -->
            <div class="cookie-stats-section">
                <h4>‚ö° Cookie Stats (Optional - Advanced Mode)</h4>
                <p class="help-text">Add detailed stats for your cookies to get personalized recommendations</p>
                <button id="addStatsBtn" class="btn-secondary">
                    ‚ûï Add Cookie Stats
                </button>
                <div id="addedStatsSummary" class="added-stats-summary"></div>
            </div>

            <!-- Optimize Button -->
            <button id="optimizeBtn" class="btn-primary">
                üöÄ Optimize Teams
            </button>
        </div>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="loading-indicator" style="display: none;">
            <div class="spinner"></div>
            <p>Generating optimal teams...</p>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="results-section" style="display: none;">
            <div class="results-header">
                <h3>üèÜ Optimized Teams</h3>
                <div id="resultsStats" class="results-stats"></div>
            </div>

            <div id="teamsList" class="teams-list"></div>
        </div>

        <!-- Counter-Team Generator Section -->
        <div class="counter-team-panel">
            <h3>‚öîÔ∏è Counter-Team Generator</h3>
            <p class="subtitle">Analyze enemy teams and generate optimal counter strategies</p>

            <!-- Enemy Team Input -->
            <div class="enemy-team-section">
                <h4>üéØ Enemy Team (5 Cookies Required)</h4>
                <p class="help-text">Select the enemy team composition you want to counter</p>

                <!-- Enemy Selected Cookies Display -->
                <div id="enemySelectedCookies" class="selected-cookies">
                    <p class="no-selection">No enemy cookies selected</p>
                </div>

                <!-- Enemy Search Bar -->
                <input type="text" id="enemyCookieSearch" class="search-input" placeholder="üîç Search enemy cookies to add...">

                <!-- Enemy Scrollable Cookie List -->
                <div id="enemyCookieList" class="cookie-list-scrollable"></div>
            </div>

            <!-- Counter Options -->
            <div class="counter-options-grid">
                <div class="setting-group">
                    <label for="counterMethod">Counter Method</label>
                    <select id="counterMethod" class="input-field">
                        <option value="random" selected>Random Sampling (Fast)</option>
                        <option value="greedy">Greedy Algorithm (Counter-focused)</option>
                        <option value="genetic">Genetic Algorithm (Best)</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label for="numCounterTeams">Counter Teams to Show</label>
                    <input type="number" id="numCounterTeams" class="input-field" value="5" min="1" max="20">
                </div>
            </div>

            <!-- Generate Counter Button -->
            <button id="generateCounterBtn" class="btn-primary">
                ‚öîÔ∏è Generate Counter-Teams
            </button>
        </div>

        <!-- Counter Results Section -->
        <div id="counterResultsSection" class="results-section" style="display: none;">
            <div class="results-header">
                <h3>‚öîÔ∏è Counter-Team Analysis</h3>
                <div id="counterResultsStats" class="results-stats"></div>
            </div>

            <!-- Enemy Analysis -->
            <div id="enemyAnalysis" class="enemy-analysis-section"></div>

            <!-- Weaknesses Found -->
            <div id="weaknessesSection" class="weaknesses-section"></div>

            <!-- Counter Strategy -->
            <div id="counterStrategySection" class="counter-strategy-section"></div>

            <!-- Counter Teams List -->
            <div id="counterTeamsList" class="teams-list"></div>
        </div>

        <!-- Statistics Panel -->
        <div class="stats-panel">
            <h3>üìä Cookie Collection Stats</h3>
            <div id="statsContent" class="stats-content">
                <p>Loading statistics...</p>
            </div>
        </div>
    </div>

    <!-- Cookie Stats Modal -->
    <div id="cookieStatsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ö° Add Cookie Stats</h3>
                <button class="modal-close" onclick="closeCookieStatsModal()">&times;</button>
            </div>

            <div class="modal-body">
                <!-- Search Bar with Autocomplete -->
                <div class="modal-search-section">
                    <input type="text" id="modalCookieSearch" class="modal-search-input"
                           placeholder="üîç Search for a cookie..." autocomplete="off">
                    <div id="cookieSearchResults" class="cookie-search-results"></div>
                </div>

                <!-- Cookie Stats Form (Hidden until cookie selected) -->
                <div id="cookieStatsForm" class="cookie-stats-form" style="display: none;">
                    <div class="form-header">
                        <h4 id="selectedCookieName"></h4>
                        <div id="selectedCookieInfo" class="cookie-info-badge"></div>
                    </div>

                    <div class="form-grid">
                        <!-- Cookie Level -->
                        <div class="form-group">
                            <label for="cookieLevel">Cookie Level</label>
                            <input type="number" id="cookieLevel" min="1" max="90" value="90">
                            <small>Max: 90</small>
                        </div>

                        <!-- Skill Level -->
                        <div class="form-group">
                            <label for="skillLevel">Skill Level</label>
                            <input type="number" id="skillLevel" min="1" max="90" value="90">
                            <small>Max: 90</small>
                        </div>

                        <!-- Toppings Section -->
                        <div class="form-group-full">
                            <h5>üç∞ Toppings (Up to 5)</h5>
                            <div id="toppingsContainer" class="toppings-container">
                                <!-- Topping slots will be added dynamically -->
                            </div>
                            <button type="button" onclick="addToppingSlot()" class="btn-add-topping">+ Add Topping</button>
                        </div>
                    </div>

                    <!-- Add to Required Cookies Checkbox -->
                    <div class="form-checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="addToRequired" checked>
                            <span>‚òë Also add to Required Cookies</span>
                        </label>
                    </div>

                    <div class="modal-actions">
                        <button type="button" onclick="saveCookieStats()" class="btn-save">Save Cookie Stats</button>
                        <button type="button" onclick="cancelCookieStats()" class="btn-cancel">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
